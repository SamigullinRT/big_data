Первые две лр я делал в коллабе так как у меня возникли проблемы с java path, в мапре и они не решались, было проще перенести всю работу на колаб.
Поэтому для начала я установил pyspark.

Преобразовал список trips в последовательность объектов Trip.
Информация о поездке включает идентификатор поездки `(trip_id)`, длительность `duration)`, дату и время начала поездки `(start_date)`, название начальной станции `(start_station_name)`, идентификатор начальной станции `(start_station_id)`, дату и время окончания поездки `(end_date)`, название конечной станции (end_station_name), идентификатор конечной станции `(end_station_id)`, идентификатор велосипеда `(bike_id)`, тип подписки `(subscription_type)` и почтовый индекс `(zip_code)`.

Сделал то же самое для станций:

Цель работы: Изучение Apache Spark, выполнение задний.
Задания:

1.	Найти велосипед с максимальным временем пробега.

Для нахождения использовал функцию keyBy которая создает пары ключ-значение, где ключом является идентификатор велосипеда `(bike_id)`, а значением - объект Trip.
Затем применил фонацию `mapValues`, применяя лямбда-функцию lambda x: x.duration к каждой паре ключ-значение, что в результате приводит к созданию новой пары, где ключом остается идентификатор велосипеда, а значением - длительность поездки.
После этого применил функцию `reduceByKey`, которая объединяет значения по одинаковым ключам, используя лямбда-функцию lambda `x1, x2: x1 + x2.`
И наконец вернул  самое большое значение `top(1, key=lambda x: x[1])` и вывел его индекс.

2.	Найти наибольшее геодезическое расстояние между станциями.
   
   Написал функцию calculate_distance, которая вычисляет расстояние между двумя точками на поверхности земли, заданными их широтой и долготой. Для этого используется формула гаверсинусов.
   
3.	Найти путь велосипеда с максимальным временем пробега через станции.

Отфильтровал записи о поездках `(tripsProcessedByModel)`, оставив только те, у которых идентификатор велосипеда равен значению `topOfDurationBicycleMap`. Отсортировал и вывел верхний.
   
4.	Найти количество велосипедов в системе.

Извлек все id значения велосипедов и удалил distinct(), повторяющиеся.
   
5.	Найти пользователей потративших на поездки более 3 часов.

   Отобрал поездки дольше 3х часов. Достал `zip_code, map(lambda x: x.zip_code)`, удалил пустые значения, `distinct()` оставил только уникальные значения.
 
